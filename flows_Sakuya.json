[{"id":"cb40cbfd.ffb358","type":"tab","label":"HASS Automations","disabled":false,"info":""},{"id":"eb42db34.b47f28","type":"mqtt-broker","z":"","name":"Localhost","broker":"localhost","port":"1883","clientid":"","usetls":false,"compatmode":false,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"4569a41f.73170c","type":"server","z":"","name":"Home Assistant","url":"http://localhost:8123","pass":"81Nanoha275!"},{"id":"5d1f0d42.48afb4","type":"ui_base","theme":{"name":"theme-light","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"},"themeState":{"base-color":{"default":"#0094CE","value":"#0094CE","edited":false},"page-titlebar-backgroundColor":{"value":"#0094CE","edited":false},"page-backgroundColor":{"value":"#fafafa","edited":false},"page-sidebar-backgroundColor":{"value":"#ffffff","edited":false},"group-textColor":{"value":"#1bbfff","edited":false},"group-borderColor":{"value":"#ffffff","edited":false},"group-backgroundColor":{"value":"#ffffff","edited":false},"widget-textColor":{"value":"#111111","edited":false},"widget-backgroundColor":{"value":"#0094ce","edited":false},"widget-borderColor":{"value":"#ffffff","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}}},"site":{"name":"Node-RED Dashboard","hideToolbar":"false","allowSwipe":"false","allowTempTheme":"true","dateFormat":"DD/MM/YYYY","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"70516358.de796c","type":"server-state-changed","z":"cb40cbfd.ffb358","name":"MM Closet Door","server":"4569a41f.73170c","entityidfilter":"binary_sensor.master_closet_door","entityidfiltertype":"exact","haltifstate":"","x":240,"y":120,"wires":[["96b1ed96.b05ff"]]},{"id":"96b1ed96.b05ff","type":"switch","z":"cb40cbfd.ffb358","name":"Opened/Closed","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":520,"y":120,"wires":[["6931de8a.13e56","158bad7c.ed0a43"],["9faf11f4.9c5aa"]]},{"id":"6931de8a.13e56","type":"api-current-state","z":"cb40cbfd.ffb358","name":"Light On?","server":"4569a41f.73170c","halt_if":"on","override_topic":true,"override_payload":true,"entity_id":"switch.master_main_closet","x":1060,"y":140,"wires":[["5334c0f3.cd70c"]]},{"id":"5334c0f3.cd70c","type":"api-call-service","z":"cb40cbfd.ffb358","name":"ON","server":"4569a41f.73170c","service_domain":"switch","service":"turn_on","data":"{   \"entity_id\": \"switch.master_main_closet\" }","mergecontext":"","x":1230,"y":140,"wires":[[]]},{"id":"b57291e0.079a5","type":"server-state-changed","z":"cb40cbfd.ffb358","name":"MM_Closet_Switch On","server":"4569a41f.73170c","entityidfilter":"switch.master_main_closet","entityidfiltertype":"exact","haltifstate":"","x":260,"y":200,"wires":[["158bad7c.ed0a43"]]},{"id":"158bad7c.ed0a43","type":"stoptimer","z":"cb40cbfd.ffb358","duration":"10","units":"Minute","payloadtype":"num","payloadval":"0","name":"","x":840,"y":200,"wires":[["9faf11f4.9c5aa"],[]]},{"id":"4a661e52.3541","type":"api-call-service","z":"cb40cbfd.ffb358","name":"OFF","server":"4569a41f.73170c","service_domain":"switch","service":"turn_off","data":"{   \"entity_id\": \"switch.master_main_closet\" }","mergecontext":"","x":1230,"y":180,"wires":[[]]},{"id":"9647e672.090e28","type":"comment","z":"cb40cbfd.ffb358","name":"Master on Main Closet Light control","info":"","x":200,"y":60,"wires":[]},{"id":"c0e17c2.c5f5a8","type":"comment","z":"cb40cbfd.ffb358","name":"Aquarium Light Control","info":"","x":160,"y":420,"wires":[]},{"id":"ec2eb1b8.76eb5","type":"api-current-state","z":"cb40cbfd.ffb358","name":"Light On?","server":"4569a41f.73170c","halt_if":"on","override_topic":true,"override_payload":true,"entity_id":"switch.aquarium_light","x":940,"y":520,"wires":[["6a0a565.d46f5a8"]]},{"id":"6a0a565.d46f5a8","type":"api-call-service","z":"cb40cbfd.ffb358","name":"ON","server":"4569a41f.73170c","service_domain":"switch","service":"turn_on","data":"{ \"entity_id\":\"switch.aquarium_light\" }","mergecontext":"","x":1110,"y":520,"wires":[[]]},{"id":"96ef31c3.f6ec6","type":"api-call-service","z":"cb40cbfd.ffb358","name":"OFF","server":"4569a41f.73170c","service_domain":"switch","service":"turn_off","data":"{ \"entity_id\":\"switch.aquarium_light\" }","mergecontext":"","x":1110,"y":560,"wires":[[]]},{"id":"a863471f.413828","type":"switch","z":"cb40cbfd.ffb358","name":"On or Off?","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":690,"y":540,"wires":[["ec2eb1b8.76eb5"],["e99800a5.502df"]]},{"id":"e99800a5.502df","type":"api-current-state","z":"cb40cbfd.ffb358","name":"Light Off?","server":"4569a41f.73170c","halt_if":"off","override_topic":true,"override_payload":true,"entity_id":"switch.aquarium_light","x":940,"y":560,"wires":[["96ef31c3.f6ec6"]]},{"id":"e25d79c9.bf04a8","type":"inject","z":"cb40cbfd.ffb358","name":"On","topic":"","payload":"1","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":250,"y":480,"wires":[["321bcd4a.ecddd2"]]},{"id":"584f99d.2deca68","type":"inject","z":"cb40cbfd.ffb358","name":"Off","topic":"","payload":"0","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":250,"y":520,"wires":[["321bcd4a.ecddd2"]]},{"id":"90fdd167.2c7f5","type":"inject","z":"cb40cbfd.ffb358","name":"","topic":"","payload":"sync","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":"10","x":250,"y":560,"wires":[["321bcd4a.ecddd2"]]},{"id":"952ee5f8.fdeed8","type":"inject","z":"cb40cbfd.ffb358","name":"","topic":"","payload":"auto","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":250,"y":600,"wires":[["321bcd4a.ecddd2"]]},{"id":"321bcd4a.ecddd2","type":"bigtimer","z":"cb40cbfd.ffb358","outtopic":"","outpayload1":"on","outpayload2":"off","name":"Sunrise/Sunset","lat":"33.88972888","lon":"-83.81535298","starttime":"5003","endtime":"5004","startoff":0,"endoff":0,"offs":0,"outtext1":"on","outtext2":"off","timeout":1440,"sun":true,"mon":true,"tue":true,"wed":true,"thu":true,"fri":true,"sat":true,"jan":true,"feb":true,"mar":true,"apr":true,"may":true,"jun":true,"jul":true,"aug":true,"sep":true,"oct":true,"nov":true,"dec":true,"day1":0,"month1":0,"day2":0,"month2":0,"day3":0,"month3":0,"day4":0,"month4":0,"day5":0,"month5":0,"day6":"","month6":"","d1":0,"w1":0,"d2":0,"w2":0,"d3":0,"w3":0,"d4":0,"w4":0,"d5":0,"w5":0,"d6":"","w6":"","xday1":"","xmonth1":"","xday2":"","xmonth2":"","xday3":"","xmonth3":"","xday4":"","xmonth4":"","xday5":"","xmonth5":"","xday6":"","xmonth6":"","xd1":"","xw1":"","xd2":"","xw2":"","xd3":"","xw3":"","xd4":"","xw4":"","xd5":"","xw5":"","xd6":"","xw6":"","suspend":false,"random":false,"repeat":false,"atstart":true,"odd":false,"even":false,"x":460,"y":540,"wires":[["a863471f.413828"],[],[]]},{"id":"9faf11f4.9c5aa","type":"api-current-state","z":"cb40cbfd.ffb358","name":"Light Off?","server":"4569a41f.73170c","halt_if":"off","override_topic":true,"override_payload":true,"entity_id":"switch.master_main_closet","x":1060,"y":180,"wires":[["4a661e52.3541"]]},{"id":"9868e14d.44fe6","type":"server-state-changed","z":"cb40cbfd.ffb358","name":"Garage Motion","server":"4569a41f.73170c","entityidfilter":"binary_sensor.garage_motion","entityidfiltertype":"exact","haltifstate":"","x":280,"y":1100,"wires":[["48407359.b7e5bc"]]},{"id":"48407359.b7e5bc","type":"switch","z":"cb40cbfd.ffb358","name":"Motion On/Off?","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":640,"y":1100,"wires":[["79859b9d.b140b4","33a6f84a.e85f18"],["33a6f84a.e85f18"]]},{"id":"79859b9d.b140b4","type":"api-current-state","z":"cb40cbfd.ffb358","name":"Light On?","server":"4569a41f.73170c","halt_if":"on","override_topic":true,"override_payload":true,"entity_id":"switch.garage_lights","x":1200,"y":1040,"wires":[["6a3bc9ff.b3d9c8"]]},{"id":"6a3bc9ff.b3d9c8","type":"api-call-service","z":"cb40cbfd.ffb358","name":"ON","server":"4569a41f.73170c","service_domain":"switch","service":"turn_on","data":"{   \"entity_id\": \"switch.garage_lights\" }","mergecontext":"","x":1450,"y":1040,"wires":[[]]},{"id":"f502be15.f789f","type":"server-state-changed","z":"cb40cbfd.ffb358","name":"switch.garage_lights","server":"4569a41f.73170c","entityidfilter":"switch.garage_lights","entityidfiltertype":"exact","haltifstate":"","x":270,"y":1020,"wires":[["33a6f84a.e85f18"]]},{"id":"33a6f84a.e85f18","type":"stoptimer","z":"cb40cbfd.ffb358","duration":"10","units":"Minute","payloadtype":"num","payloadval":"0","name":"","x":900,"y":1020,"wires":[["3056efd4.ce836"],[]]},{"id":"3056efd4.ce836","type":"api-current-state","z":"cb40cbfd.ffb358","name":"Motion On?","server":"4569a41f.73170c","halt_if":"on","override_topic":true,"override_payload":true,"entity_id":"binary_sensor.garage_motion","x":1110,"y":1100,"wires":[["4c2b87bf.240748"]]},{"id":"61152cb0.ee3f34","type":"api-call-service","z":"cb40cbfd.ffb358","name":"OFF","server":"4569a41f.73170c","service_domain":"switch","service":"turn_off","data":"{   \"entity_id\": \"switch.garage_lights\" }","mergecontext":"","x":1450,"y":1100,"wires":[[]]},{"id":"d38ce03f.d07e9","type":"comment","z":"cb40cbfd.ffb358","name":"Master on Main Closet Light control","info":"","x":200,"y":760,"wires":[]},{"id":"4c2b87bf.240748","type":"api-current-state","z":"cb40cbfd.ffb358","name":"Light Off?","server":"4569a41f.73170c","halt_if":"off","override_topic":true,"override_payload":true,"entity_id":"switch.garage_lights","x":1280,"y":1100,"wires":[["61152cb0.ee3f34"]]},{"id":"c8a18881.9db8c8","type":"server-state-changed","z":"cb40cbfd.ffb358","name":"Garage Door state","server":"4569a41f.73170c","entityidfilter":"cover.linear_gd00z4_garage_door_opener_remote_controller_barrier_state","entityidfiltertype":"exact","haltifstate":"","x":270,"y":860,"wires":[["530a9776.5d1f48"]]},{"id":"530a9776.5d1f48","type":"switch","z":"cb40cbfd.ffb358","name":"Motion On/Off?","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"open","vt":"str"},{"t":"eq","v":"closed","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":640,"y":860,"wires":[["79859b9d.b140b4","33a6f84a.e85f18"],["33a6f84a.e85f18"]]},{"id":"7957d3b6.1c1fac","type":"api-current-state","z":"cb40cbfd.ffb358","name":"Light Off?","server":"4569a41f.73170c","halt_if":"off","override_topic":true,"override_payload":true,"entity_id":"switch.garage_lights","x":660,"y":940,"wires":[["33a6f84a.e85f18"]]},{"id":"34287961.2078c6","type":"inject","z":"cb40cbfd.ffb358","name":"Startup Sync","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":"5","x":190,"y":280,"wires":[["d18c5d29.0f2ae"]]},{"id":"f0a8fac1.7692a8","type":"api-current-state","z":"cb40cbfd.ffb358","name":"Light Off?","server":"4569a41f.73170c","halt_if":"off","override_topic":true,"override_payload":true,"entity_id":"switch.master_main_closet","x":620,"y":280,"wires":[["158bad7c.ed0a43"]]},{"id":"a76941ca.57f93","type":"status","z":"cb40cbfd.ffb358","name":"","scope":["70516358.de796c"],"x":180,"y":320,"wires":[["d473e585.0cc7d8"]]},{"id":"d473e585.0cc7d8","type":"switch","z":"cb40cbfd.ffb358","name":"","property":"status.text","propertyType":"msg","rules":[{"t":"eq","v":"connected","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":310,"y":320,"wires":[["d18c5d29.0f2ae"]]},{"id":"d18c5d29.0f2ae","type":"delay","z":"cb40cbfd.ffb358","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":480,"y":280,"wires":[["f0a8fac1.7692a8"]]},{"id":"66f064f4.39ccfc","type":"inject","z":"cb40cbfd.ffb358","name":"Startup Sync","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":"5","x":210,"y":920,"wires":[["30037a60.864c16"]]},{"id":"9f56423a.30fc1","type":"status","z":"cb40cbfd.ffb358","name":"","scope":["f502be15.f789f"],"x":200,"y":960,"wires":[["141a86b.30d1779"]]},{"id":"141a86b.30d1779","type":"switch","z":"cb40cbfd.ffb358","name":"","property":"status.text","propertyType":"msg","rules":[{"t":"eq","v":"connected","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":330,"y":960,"wires":[["30037a60.864c16"]]},{"id":"30037a60.864c16","type":"delay","z":"cb40cbfd.ffb358","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":500,"y":940,"wires":[["7957d3b6.1c1fac"]]},{"id":"1f208b5b.137595","type":"server-state-changed","z":"cb40cbfd.ffb358","name":"","server":"4569a41f.73170c","entityidfilter":"sensor.esp32_2852c4_rtd_temp","entityidfiltertype":"exact","haltifstate":"","x":260,"y":1460,"wires":[["b567c25b.a51d1","5102bdc1.456724"]]},{"id":"b567c25b.a51d1","type":"debug","z":"cb40cbfd.ffb358","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":550,"y":1540,"wires":[]},{"id":"5102bdc1.456724","type":"json","z":"cb40cbfd.ffb358","name":"","property":"payload","action":"","pretty":true,"x":550,"y":1460,"wires":[["b43732e5.45596","9bdc5b41.58ed58"]]},{"id":"7c8c79f4.f8f388","type":"debug","z":"cb40cbfd.ffb358","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":910,"y":1460,"wires":[]},{"id":"b43732e5.45596","type":"debug","z":"cb40cbfd.ffb358","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":710,"y":1540,"wires":[]},{"id":"9bdc5b41.58ed58","type":"function","z":"cb40cbfd.ffb358","name":"On or Off","func":"if (msg.payload >= 100) {\n    var pl = \"On\";\n}\nif (msg.payload < 100) {\n    var pl = \"Off\";\n}\nvar newMsg = [{ topic:msg.topic,\n                payload:pl,\n                temperature:msg.payload,\n                _msgid:msg._msgid\n}];\nreturn newMsg;","outputs":1,"noerr":0,"x":740,"y":1440,"wires":[["7c8c79f4.f8f388"]]}]